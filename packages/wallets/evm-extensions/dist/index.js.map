{
  "version": 3,
  "sources": ["../src/index.ts"],
  "sourcesContent": [
    "import {\n  Chain,\n  ChainId,\n  ChainToHexChainId,\n  type ConnectWalletParams,\n  type EVMChain,\n  type EthereumWindowProvider,\n  WalletOption,\n  addEVMWalletNetwork,\n  ensureEVMApiKeys,\n  prepareNetworkSwitch,\n  setRequestClientConfig,\n  switchEVMWalletNetwork,\n} from \"@swapkit/helpers\";\nimport {\n  type AVAXToolbox,\n  type BrowserProvider,\n  type Eip1193Provider,\n  getToolboxByChain,\n} from \"@swapkit/toolbox-evm\";\n\ndeclare const window: {\n  ethereum: EthereumWindowProvider;\n  trustwallet: EthereumWindowProvider;\n  coinbaseWalletExtension: EthereumWindowProvider;\n  braveSolana: Todo;\n} & Window;\n\nexport type EVMWalletOptions =\n  | WalletOption.BRAVE\n  | WalletOption.OKX_MOBILE\n  | WalletOption.METAMASK\n  | WalletOption.TRUSTWALLET_WEB\n  | WalletOption.COINBASE_WEB\n  | WalletOption.EIP6963;\n\nconst getWalletForType = (\n  walletType:\n    | WalletOption.BRAVE\n    | WalletOption.OKX_MOBILE\n    | WalletOption.METAMASK\n    | WalletOption.TRUSTWALLET_WEB\n    | WalletOption.COINBASE_WEB,\n) => {\n  switch (walletType) {\n    case WalletOption.BRAVE:\n    case WalletOption.METAMASK:\n    case WalletOption.OKX_MOBILE:\n      return window.ethereum;\n    case WalletOption.COINBASE_WEB:\n      return window.coinbaseWalletExtension;\n    case WalletOption.TRUSTWALLET_WEB:\n      return window.trustwallet;\n  }\n};\n\nexport const getWeb3WalletMethods = async ({\n  ethereumWindowProvider,\n  chain,\n  covalentApiKey,\n  ethplorerApiKey,\n  provider,\n}: {\n  ethereumWindowProvider: Eip1193Provider | undefined;\n  chain: EVMChain;\n  covalentApiKey?: string;\n  ethplorerApiKey?: string;\n  provider: BrowserProvider;\n}) => {\n  if (!ethereumWindowProvider) throw new Error(\"Requested web3 wallet is not installed\");\n\n  const keys = ensureEVMApiKeys({ chain, covalentApiKey, ethplorerApiKey });\n  const signer = await provider.getSigner();\n\n  const toolbox = getToolboxByChain(chain)({ ...keys, provider, signer });\n\n  try {\n    chain !== Chain.Ethereum &&\n      chain !== Chain.Sepolia &&\n      (await addEVMWalletNetwork(\n        provider,\n        (toolbox as ReturnType<typeof AVAXToolbox>).getNetworkParams(),\n      ));\n\n    chain === Chain.Sepolia && (await switchEVMWalletNetwork(provider, ChainId.SepoliaHex));\n  } catch (_error) {\n    throw new Error(`Failed to add/switch ${chain} network: ${chain}`);\n  }\n\n  return prepareNetworkSwitch<typeof toolbox>({\n    toolbox: { ...toolbox },\n    chainId: ChainToHexChainId[chain],\n    provider,\n  });\n};\n\nfunction connectEVMWallet({\n  addChain,\n  config: { covalentApiKey, ethplorerApiKey, thorswapApiKey },\n}: ConnectWalletParams) {\n  return async function connectEVMWallet(\n    chains: EVMChain[],\n    walletType: EVMWalletOptions = WalletOption.METAMASK,\n    eip1193Provider?: Eip1193Provider,\n  ) {\n    setRequestClientConfig({ apiKey: thorswapApiKey });\n\n    const promises = chains.map(async (chain) => {\n      const { BrowserProvider, getProvider } = await import(\"@swapkit/toolbox-evm\");\n\n      if (walletType === WalletOption.EIP6963) {\n        if (!eip1193Provider) throw new Error(\"Missing provider\");\n        const provider = new BrowserProvider(eip1193Provider, \"any\");\n        await provider.send(\"eth_requestAccounts\", []);\n        const signer = await provider.getSigner();\n        const address = await signer.getAddress();\n\n        const walletMethods = await getWeb3WalletMethods({\n          chain,\n          ethplorerApiKey,\n          covalentApiKey,\n          ethereumWindowProvider: eip1193Provider,\n          provider,\n        });\n\n        const getBalance = async (potentialScamFilter = true) =>\n          walletMethods.getBalance(address, potentialScamFilter, getProvider(chain));\n\n        addChain({\n          ...walletMethods,\n          chain,\n          address,\n          getBalance,\n          balance: [],\n          walletType,\n        });\n        return;\n      }\n\n      const web3provider = new BrowserProvider(getWalletForType(walletType), \"any\");\n      await web3provider.send(\"eth_requestAccounts\", []);\n      const signer = await web3provider.getSigner();\n      const address = await signer.getAddress();\n\n      const walletMethods = await getWeb3WalletMethods({\n        chain,\n        ethplorerApiKey,\n        covalentApiKey,\n        ethereumWindowProvider: getWalletForType(walletType),\n        provider: web3provider,\n      });\n\n      const getBalance = async (potentialScamFilter = true) =>\n        walletMethods.getBalance(address, potentialScamFilter, getProvider(chain));\n\n      addChain({\n        ...walletMethods,\n        chain,\n        address,\n        getBalance,\n        balance: [],\n        walletType,\n      });\n    });\n\n    await Promise.all(promises);\n\n    return true;\n  };\n}\n\nexport const evmWallet = { connectEVMWallet } as const;\n"
  ],
  "mappings": "mSAAA,gBACE,aACA,uBACA,kBAIA,yBACA,sBACA,0BACA,4BACA,4BACA,yBAEF,4BAIE,6BA8EF,SAAS,CAAgB,EACvB,WACA,QAAU,iBAAgB,kBAAiB,mBACrB,CACtB,OAAO,eAAe,CAAgB,CACpC,EACA,EAA+B,EAAa,SAC5C,EACA,CACA,EAAuB,CAAE,OAAQ,CAAe,CAAC,EAEjD,MAAM,EAAW,EAAO,IAAI,MAAO,IAAU,CAC3C,MAAQ,kBAAiB,eAAgB,KAAa,gCAEtD,GAAI,IAAe,EAAa,QAAS,CACvC,IAAK,EAAiB,MAAM,IAAI,MAAM,kBAAkB,EACxD,MAAM,EAAW,IAAI,EAAgB,EAAiB,KAAK,EAC3D,MAAM,EAAS,KAAK,sBAAuB,CAAC,CAAC,EAE7C,MAAM,EAAU,MADD,MAAM,EAAS,UAAU,GACX,WAAW,EAElC,EAAgB,MAAM,EAAqB,CAC/C,QACA,kBACA,iBACA,uBAAwB,EACxB,UACF,CAAC,EAKD,EAAS,IACJ,EACH,QACA,UACA,WAPiB,MAAO,EAAsB,KAC9C,EAAc,WAAW,EAAS,EAAqB,EAAY,CAAK,CAAC,EAOzE,QAAS,CAAC,EACV,YACF,CAAC,EACD,OAGF,MAAM,EAAe,IAAI,EAAgB,EAAiB,CAAU,EAAG,KAAK,EAC5E,MAAM,EAAa,KAAK,sBAAuB,CAAC,CAAC,EAEjD,MAAM,EAAU,MADD,MAAM,EAAa,UAAU,GACf,WAAW,EAElC,EAAgB,MAAM,EAAqB,CAC/C,QACA,kBACA,iBACA,uBAAwB,EAAiB,CAAU,EACnD,SAAU,CACZ,CAAC,EAKD,EAAS,IACJ,EACH,QACA,UACA,WAPiB,MAAO,EAAsB,KAC9C,EAAc,WAAW,EAAS,EAAqB,EAAY,CAAK,CAAC,EAOzE,QAAS,CAAC,EACV,YACF,CAAC,EACF,EAID,OAFA,MAAM,QAAQ,IAAI,CAAQ,EAEnB,IAnIX,IAAM,EAAmB,CACvB,IAMG,CACH,OAAQ,QACD,EAAa,WACb,EAAa,cACb,EAAa,WAChB,OAAO,OAAO,cACX,EAAa,aAChB,OAAO,OAAO,6BACX,EAAa,gBAChB,OAAO,OAAO,cAIP,EAAuB,OAClC,yBACA,QACA,iBACA,kBACA,cAOI,CACJ,IAAK,EAAwB,MAAM,IAAI,MAAM,wCAAwC,EAErF,MAAM,EAAO,EAAiB,CAAE,QAAO,iBAAgB,iBAAgB,CAAC,EAClE,EAAS,MAAM,EAAS,UAAU,EAElC,EAAU,EAAkB,CAAK,EAAE,IAAK,EAAM,WAAU,QAAO,CAAC,EAEtE,GAAI,CACF,IAAU,EAAM,UACd,IAAU,EAAM,SACf,MAAM,EACL,EACC,EAA2C,iBAAiB,CAC/D,EAEF,IAAU,EAAM,SAAY,MAAM,EAAuB,EAAU,EAAQ,UAAU,QAC9E,EAAP,CACA,MAAM,IAAI,MAAM,wBAAwB,cAAkB,GAAO,EAGnE,OAAO,EAAqC,CAC1C,QAAS,IAAK,CAAQ,EACtB,QAAS,EAAkB,GAC3B,UACF,CAAC,GA8EU,EAAY,CAAE,kBAAiB",
  "debugId": "834A8F6E162D665264756E2164756E21",
  "names": []
}