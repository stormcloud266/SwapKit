{
  "version": 3,
  "sources": ["../src/polkadot.ts", "../src/helpers.ts"],
  "sourcesContent": [
    "import {\n  Chain,\n  type ConnectWalletParams,\n  WalletOption,\n  setRequestClientConfig,\n} from \"@swapkit/helpers\";\nimport { getWalletForChain } from \"./helpers\";\n\nconst POLKADOT_SUPPORTED_CHAINS = [Chain.Polkadot] as const;\n\nfunction connectPolkadotJs({\n  addChain,\n  config: { thorswapApiKey, covalentApiKey, ethplorerApiKey },\n}: ConnectWalletParams) {\n  return async function connectPolkadotJs(chains: (typeof POLKADOT_SUPPORTED_CHAINS)[number][]) {\n    setRequestClientConfig({ apiKey: thorswapApiKey });\n\n    const promises = chains.map(async (chain) => {\n      const { address, walletMethods } = await getWalletForChain({\n        chain,\n        covalentApiKey,\n        ethplorerApiKey,\n      });\n\n      addChain({\n        ...walletMethods,\n        address,\n        chain,\n        balance: [],\n        walletType: WalletOption.POLKADOT_JS,\n      });\n    });\n\n    await Promise.all(promises);\n\n    return true;\n  };\n}\n\nexport const polkadotWallet = { connectPolkadotJs } as const;\n",
    "import { Chain, SwapKitError, WalletOption } from \"@swapkit/helpers\";\n\nimport { decodeAddress, encodeAddress } from \"@polkadot/util-crypto\";\n\nimport type { InjectedWindow, PolkadotToolbox } from \"@swapkit/toolbox-substrate\";\n\nexport const convertAddress = (inputAddress: string, newPrefix: number): string => {\n  const decodedAddress = decodeAddress(inputAddress);\n  const convertedAddress = encodeAddress(decodedAddress, newPrefix);\n  return convertedAddress;\n};\n\nexport const getWalletForChain = async ({\n  chain,\n}: {\n  chain: Chain;\n  ethplorerApiKey?: string;\n  covalentApiKey?: string;\n}): Promise<{\n  walletMethods: Awaited<ReturnType<typeof PolkadotToolbox>>;\n  address: string;\n}> => {\n  switch (chain) {\n    case Chain.Polkadot: {\n      const { getToolboxByChain } = await import(\"@swapkit/toolbox-substrate\");\n      const injectedWindow = window as Window & InjectedWindow;\n      const injectedExtension = injectedWindow?.injectedWeb3?.[\"polkadot-js\"];\n\n      const rawExtension = await injectedExtension?.enable?.(\"polkadot-js\");\n      if (!rawExtension) {\n        throw new SwapKitError({\n          errorKey: \"wallet_polkadot_not_found\",\n          info: { chain },\n        });\n      }\n\n      const toolbox = await getToolboxByChain(chain, { signer: rawExtension.signer });\n      const accounts = await rawExtension.accounts.get();\n      if (!accounts[0]?.address) {\n        throw new SwapKitError({\n          errorKey: \"wallet_missing_params\",\n          info: { wallet: WalletOption.POLKADOT_JS, accounts, address: accounts[0]?.address },\n        });\n      }\n      const subAddress: string = accounts[0].address;\n      const newPrefix = 0;\n      const address = convertAddress(subAddress, newPrefix);\n      return { walletMethods: toolbox, address };\n    }\n\n    default:\n      throw new SwapKitError({\n        errorKey: \"wallet_chain_not_supported\",\n        info: { chain, wallet: WalletOption.POLKADOT_JS },\n      });\n  }\n};\n"
  ],
  "mappings": "mSAAA,gBACE,kBAEA,4BACA,yBCJF,gBAAS,kBAAO,kBAAc,yBAE9B,wBAAS,mBAAe,8BAIjB,IAAM,EAAiB,CAAC,EAAsB,IAA8B,CACjF,MAAM,EAAiB,EAAc,CAAY,EAEjD,OADyB,EAAc,EAAgB,CAAS,GAIrD,EAAoB,OAC/B,WAQI,CACJ,OAAQ,QACD,EAAM,SAAU,CACnB,MAAQ,qBAAsB,KAAa,sCAIrC,EAAe,MAHE,QACmB,eAAe,gBAEX,SAAS,aAAa,EACpE,IAAK,EACH,MAAM,IAAI,EAAa,CACrB,SAAU,4BACV,KAAM,CAAE,OAAM,CAChB,CAAC,EAGH,MAAM,EAAU,MAAM,EAAkB,EAAO,CAAE,OAAQ,EAAa,MAAO,CAAC,EACxE,EAAW,MAAM,EAAa,SAAS,IAAI,EACjD,IAAK,EAAS,IAAI,QAChB,MAAM,IAAI,EAAa,CACrB,SAAU,wBACV,KAAM,CAAE,OAAQ,EAAa,YAAa,WAAU,QAAS,EAAS,IAAI,OAAQ,CACpF,CAAC,EAEH,MAAM,EAAqB,EAAS,GAAG,QAEjC,EAAU,EAAe,EADb,CACkC,EACpD,MAAO,CAAE,cAAe,EAAS,SAAQ,CAC3C,SAGE,MAAM,IAAI,EAAa,CACrB,SAAU,6BACV,KAAM,CAAE,QAAO,OAAQ,EAAa,WAAY,CAClD,CAAC,ID5CP,SAAS,CAAiB,EACxB,WACA,QAAU,iBAAgB,iBAAgB,oBACpB,CACtB,OAAO,eAAe,CAAiB,CAAC,EAAsD,CAC5F,EAAuB,CAAE,OAAQ,CAAe,CAAC,EAEjD,MAAM,EAAW,EAAO,IAAI,MAAO,IAAU,CAC3C,MAAQ,UAAS,iBAAkB,MAAM,EAAkB,CACzD,QACA,iBACA,iBACF,CAAC,EAED,EAAS,IACJ,EACH,UACA,QACA,QAAS,CAAC,EACV,WAAY,EAAa,WAC3B,CAAC,EACF,EAID,OAFA,MAAM,QAAQ,IAAI,CAAQ,EAEnB,IA3BX,IAAM,EAA4B,CAAC,EAAM,QAAQ,EA+BpC,EAAiB,CAAE,mBAAkB",
  "debugId": "1428EA9C522784E664756E2164756E21",
  "names": []
}